After training size probing
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    4879 KB |    2484 MB |    7088 MB |    7084 MB |
|       from large pool |       0 KB |    2479 MB |    7044 MB |    7044 MB |
|       from small pool |    4879 KB |       8 MB |      44 MB |      39 MB |
|---------------------------------------------------------------------------|
| Active memory         |    4879 KB |    2484 MB |    7088 MB |    7084 MB |
|       from large pool |       0 KB |    2479 MB |    7044 MB |    7044 MB |
|       from small pool |    4879 KB |       8 MB |      44 MB |      39 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8192 KB |    2500 MB |    4990 MB |    4982 MB |
|       from large pool |       0 KB |    2490 MB |    4980 MB |    4980 MB |
|       from small pool |    8192 KB |      10 MB |      10 MB |       2 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    3312 KB |  743805 KB |    3056 MB |    3053 MB |
|       from large pool |       0 KB |  741712 KB |    3002 MB |    3002 MB |
|       from small pool |    3312 KB |    4394 KB |      54 MB |      50 MB |
|---------------------------------------------------------------------------|
| Allocations           |      12    |      35    |     483    |     471    |
|       from large pool |       0    |      11    |      48    |      48    |
|       from small pool |      12    |      29    |     435    |     423    |
|---------------------------------------------------------------------------|
| Active allocs         |      12    |      35    |     483    |     471    |
|       from large pool |       0    |      11    |      48    |      48    |
|       from small pool |      12    |      29    |     435    |     423    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       4    |      14    |      23    |      19    |
|       from large pool |       0    |       9    |      18    |      18    |
|       from small pool |       4    |       5    |       5    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      18    |     214    |     205    |
|       from large pool |       0    |       7    |      34    |      34    |
|       from small pool |       9    |      13    |     180    |     171    |
|===========================================================================|

After training size probing
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    4879 KB |    2484 MB |   14176 MB |   14171 MB |
|       from large pool |       0 KB |    2479 MB |   14089 MB |   14089 MB |
|       from small pool |    4879 KB |       8 MB |      86 MB |      82 MB |
|---------------------------------------------------------------------------|
| Active memory         |    4879 KB |    2484 MB |   14176 MB |   14171 MB |
|       from large pool |       0 KB |    2479 MB |   14089 MB |   14089 MB |
|       from small pool |    4879 KB |       8 MB |      86 MB |      82 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8192 KB |    2500 MB |    9972 MB |    9964 MB |
|       from large pool |       0 KB |    2490 MB |    9960 MB |    9960 MB |
|       from small pool |    8192 KB |      10 MB |      12 MB |       4 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    3312 KB |  743805 KB |    6107 MB |    6104 MB |
|       from large pool |       0 KB |  741712 KB |    6004 MB |    6004 MB |
|       from small pool |    3312 KB |    4394 KB |     102 MB |      99 MB |
|---------------------------------------------------------------------------|
| Allocations           |      12    |      35    |     958    |     946    |
|       from large pool |       0    |      11    |      96    |      96    |
|       from small pool |      12    |      29    |     862    |     850    |
|---------------------------------------------------------------------------|
| Active allocs         |      12    |      35    |     958    |     946    |
|       from large pool |       0    |      11    |      96    |      96    |
|       from small pool |      12    |      29    |     862    |     850    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       4    |      14    |      42    |      38    |
|       from large pool |       0    |       9    |      36    |      36    |
|       from small pool |       4    |       5    |       6    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      18    |     419    |     411    |
|       from large pool |       0    |       7    |      68    |      68    |
|       from small pool |       8    |      13    |     351    |     343    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  132535 MB |  132527 MB |
|       from large pool |       0 KB |    2479 MB |  131645 MB |  131645 MB |
|       from small pool |    8131 KB |      11 MB |     890 MB |     882 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  132535 MB |  132527 MB |
|       from large pool |       0 KB |    2479 MB |  131645 MB |  131645 MB |
|       from small pool |    8131 KB |      11 MB |     890 MB |     882 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    3304 MB |   13268 MB |    9964 MB |
|       from large pool |    3290 MB |    3290 MB |   13250 MB |    9960 MB |
|       from small pool |      14 MB |      14 MB |      18 MB |       4 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1025 MB |  108954 MB |  108952 MB |
|       from large pool |       0 KB |    1021 MB |  107839 MB |  107839 MB |
|       from small pool |    2108 KB |       4 MB |    1114 MB |    1112 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |    9196    |    9178    |
|       from large pool |       0    |      11    |     908    |     908    |
|       from small pool |      18    |      37    |    8288    |    8270    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |    9196    |    9178    |
|       from large pool |       0    |      11    |     908    |     908    |
|       from small pool |      18    |      37    |    8288    |    8270    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      17    |      55    |      38    |
|       from large pool |      10    |      10    |      46    |      36    |
|       from small pool |       7    |       7    |       9    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |    4115    |    4107    |
|       from large pool |       0    |       8    |     703    |     703    |
|       from small pool |       8    |      14    |    3412    |    3404    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  132535 MB |  132527 MB |
|       from large pool |       0 KB |    2479 MB |  131645 MB |  131645 MB |
|       from small pool |    8131 KB |      11 MB |     890 MB |     882 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  132535 MB |  132527 MB |
|       from large pool |       0 KB |    2479 MB |  131645 MB |  131645 MB |
|       from small pool |    8131 KB |      11 MB |     890 MB |     882 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    3304 MB |   13268 MB |    9964 MB |
|       from large pool |    3290 MB |    3290 MB |   13250 MB |    9960 MB |
|       from small pool |      14 MB |      14 MB |      18 MB |       4 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1025 MB |  108954 MB |  108952 MB |
|       from large pool |       0 KB |    1021 MB |  107839 MB |  107839 MB |
|       from small pool |    2108 KB |       4 MB |    1114 MB |    1112 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |    9196    |    9178    |
|       from large pool |       0    |      11    |     908    |     908    |
|       from small pool |      18    |      37    |    8288    |    8270    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |    9196    |    9178    |
|       from large pool |       0    |      11    |     908    |     908    |
|       from small pool |      18    |      37    |    8288    |    8270    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      17    |      55    |      38    |
|       from large pool |      10    |      10    |      46    |      36    |
|       from small pool |       7    |       7    |       9    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |    4115    |    4107    |
|       from large pool |       0    |       8    |     703    |     703    |
|       from small pool |       8    |      14    |    3412    |    3404    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  145740 MB |  145732 MB |
|       from large pool |       0 KB |    2479 MB |  144811 MB |  144811 MB |
|       from small pool |    8131 KB |      11 MB |     929 MB |     921 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  145740 MB |  145732 MB |
|       from large pool |       0 KB |    2479 MB |  144811 MB |  144811 MB |
|       from small pool |    8131 KB |      11 MB |     929 MB |     921 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3576 MB |    5040 MB |   22136 MB |   18560 MB |
|       from large pool |    3564 MB |    5026 MB |   22114 MB |   18550 MB |
|       from small pool |      12 MB |      14 MB |      22 MB |      10 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  115348 MB |  115346 MB |
|       from large pool |       0 KB |    1736 MB |  114187 MB |  114187 MB |
|       from small pool |    2108 KB |       4 MB |    1161 MB |    1158 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |    9490    |    9472    |
|       from large pool |       0    |      11    |     965    |     965    |
|       from small pool |      18    |      37    |    8525    |    8507    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |    9490    |    9472    |
|       from large pool |       0    |      11    |     965    |     965    |
|       from small pool |      18    |      37    |    8525    |    8507    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      12    |      18    |      70    |      58    |
|       from large pool |       6    |      11    |      59    |      53    |
|       from small pool |       6    |       7    |      11    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |    4230    |    4222    |
|       from large pool |       0    |       8    |     734    |     734    |
|       from small pool |       8    |      14    |    3496    |    3488    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  264095 MB |  264087 MB |
|       from large pool |       0 KB |    2479 MB |  262367 MB |  262367 MB |
|       from small pool |    8131 KB |      11 MB |    1728 MB |    1720 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  264095 MB |  264087 MB |
|       from large pool |       0 KB |    2479 MB |  262367 MB |  262367 MB |
|       from small pool |    8131 KB |      11 MB |    1728 MB |    1720 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   25430 MB |   22126 MB |
|       from large pool |    3290 MB |    5026 MB |   25404 MB |   22114 MB |
|       from small pool |      14 MB |      14 MB |      26 MB |      12 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  218192 MB |  218190 MB |
|       from large pool |       0 KB |    1736 MB |  216021 MB |  216021 MB |
|       from small pool |    2108 KB |       4 MB |    2170 MB |    2168 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   17718    |   17700    |
|       from large pool |       0    |      11    |    1777    |    1777    |
|       from small pool |      18    |      37    |   15941    |   15923    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   17718    |   17700    |
|       from large pool |       0    |      11    |    1777    |    1777    |
|       from small pool |      18    |      37    |   15941    |   15923    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |      82    |      65    |
|       from large pool |      10    |      11    |      69    |      59    |
|       from small pool |       7    |       7    |      13    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |    7922    |    7914    |
|       from large pool |       0    |       8    |    1369    |    1369    |
|       from small pool |       8    |      14    |    6553    |    6545    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  264095 MB |  264087 MB |
|       from large pool |       0 KB |    2479 MB |  262367 MB |  262367 MB |
|       from small pool |    8131 KB |      11 MB |    1728 MB |    1720 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  264095 MB |  264087 MB |
|       from large pool |       0 KB |    2479 MB |  262367 MB |  262367 MB |
|       from small pool |    8131 KB |      11 MB |    1728 MB |    1720 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   25430 MB |   22126 MB |
|       from large pool |    3290 MB |    5026 MB |   25404 MB |   22114 MB |
|       from small pool |      14 MB |      14 MB |      26 MB |      12 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  218192 MB |  218190 MB |
|       from large pool |       0 KB |    1736 MB |  216021 MB |  216021 MB |
|       from small pool |    2108 KB |       4 MB |    2170 MB |    2168 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   17718    |   17700    |
|       from large pool |       0    |      11    |    1777    |    1777    |
|       from small pool |      18    |      37    |   15941    |   15923    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   17718    |   17700    |
|       from large pool |       0    |      11    |    1777    |    1777    |
|       from small pool |      18    |      37    |   15941    |   15923    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |      82    |      65    |
|       from large pool |      10    |      11    |      69    |      59    |
|       from small pool |       7    |       7    |      13    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |    7922    |    7914    |
|       from large pool |       0    |       8    |    1369    |    1369    |
|       from small pool |       8    |      14    |    6553    |    6545    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  268494 MB |  268486 MB |
|       from large pool |       0 KB |    2479 MB |  266753 MB |  266753 MB |
|       from small pool |    8131 KB |      11 MB |    1741 MB |    1733 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  268494 MB |  268486 MB |
|       from large pool |       0 KB |    2479 MB |  266753 MB |  266753 MB |
|       from small pool |    8131 KB |      11 MB |    1741 MB |    1733 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |   27166 MB |   22126 MB |
|       from large pool |    5026 MB |    5026 MB |   27140 MB |   22114 MB |
|       from small pool |      14 MB |      14 MB |      26 MB |      12 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  220333 MB |  220331 MB |
|       from large pool |       0 KB |    1736 MB |  218147 MB |  218147 MB |
|       from small pool |    2108 KB |       4 MB |    2186 MB |    2184 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   17816    |   17798    |
|       from large pool |       0    |      11    |    1796    |    1796    |
|       from small pool |      18    |      37    |   16020    |   16002    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   17816    |   17798    |
|       from large pool |       0    |      11    |    1796    |    1796    |
|       from small pool |      18    |      37    |   16020    |   16002    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |      83    |      65    |
|       from large pool |      11    |      11    |      70    |      59    |
|       from small pool |       7    |       7    |      13    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |    7960    |    7952    |
|       from large pool |       0    |       8    |    1380    |    1380    |
|       from small pool |       8    |      14    |    6580    |    6572    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  386849 MB |  386841 MB |
|       from large pool |       0 KB |    2479 MB |  384309 MB |  384309 MB |
|       from small pool |    8131 KB |      11 MB |    2539 MB |    2531 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  386849 MB |  386841 MB |
|       from large pool |       0 KB |    2479 MB |  384309 MB |  384309 MB |
|       from small pool |    8131 KB |      11 MB |    2539 MB |    2531 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   30460 MB |   27156 MB |
|       from large pool |    3290 MB |    5026 MB |   30430 MB |   27140 MB |
|       from small pool |      14 MB |      14 MB |      30 MB |      16 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  323177 MB |  323175 MB |
|       from large pool |       0 KB |    1736 MB |  319981 MB |  319981 MB |
|       from small pool |    2108 KB |       4 MB |    3196 MB |    3194 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   26044    |   26026    |
|       from large pool |       0    |      11    |    2608    |    2608    |
|       from small pool |      18    |      37    |   23436    |   23418    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   26044    |   26026    |
|       from large pool |       0    |      11    |    2608    |    2608    |
|       from small pool |      18    |      37    |   23436    |   23418    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |      95    |      78    |
|       from large pool |      10    |      11    |      80    |      70    |
|       from small pool |       7    |       7    |      15    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   11671    |   11663    |
|       from large pool |       0    |       8    |    2015    |    2015    |
|       from small pool |       8    |      14    |    9656    |    9648    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  386849 MB |  386841 MB |
|       from large pool |       0 KB |    2479 MB |  384309 MB |  384309 MB |
|       from small pool |    8131 KB |      11 MB |    2539 MB |    2531 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  386849 MB |  386841 MB |
|       from large pool |       0 KB |    2479 MB |  384309 MB |  384309 MB |
|       from small pool |    8131 KB |      11 MB |    2539 MB |    2531 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   30460 MB |   27156 MB |
|       from large pool |    3290 MB |    5026 MB |   30430 MB |   27140 MB |
|       from small pool |      14 MB |      14 MB |      30 MB |      16 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  323177 MB |  323175 MB |
|       from large pool |       0 KB |    1736 MB |  319981 MB |  319981 MB |
|       from small pool |    2108 KB |       4 MB |    3196 MB |    3194 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   26044    |   26026    |
|       from large pool |       0    |      11    |    2608    |    2608    |
|       from small pool |      18    |      37    |   23436    |   23418    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   26044    |   26026    |
|       from large pool |       0    |      11    |    2608    |    2608    |
|       from small pool |      18    |      37    |   23436    |   23418    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |      95    |      78    |
|       from large pool |      10    |      11    |      80    |      70    |
|       from small pool |       7    |       7    |      15    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   11671    |   11663    |
|       from large pool |       0    |       8    |    2015    |    2015    |
|       from small pool |       8    |      14    |    9656    |    9648    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  391247 MB |  391240 MB |
|       from large pool |       0 KB |    2479 MB |  388695 MB |  388695 MB |
|       from small pool |    8131 KB |      11 MB |    2552 MB |    2544 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  391247 MB |  391240 MB |
|       from large pool |       0 KB |    2479 MB |  388695 MB |  388695 MB |
|       from small pool |    8131 KB |      11 MB |    2552 MB |    2544 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |   32196 MB |   27156 MB |
|       from large pool |    5026 MB |    5026 MB |   32166 MB |   27140 MB |
|       from small pool |      14 MB |      14 MB |      30 MB |      16 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  325318 MB |  325316 MB |
|       from large pool |       0 KB |    1736 MB |  322107 MB |  322107 MB |
|       from small pool |    2108 KB |       4 MB |    3211 MB |    3209 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   26142    |   26124    |
|       from large pool |       0    |      11    |    2627    |    2627    |
|       from small pool |      18    |      37    |   23515    |   23497    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   26142    |   26124    |
|       from large pool |       0    |      11    |    2627    |    2627    |
|       from small pool |      18    |      37    |   23515    |   23497    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |      96    |      78    |
|       from large pool |      11    |      11    |      81    |      70    |
|       from small pool |       7    |       7    |      15    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   11710    |   11702    |
|       from large pool |       0    |       8    |    2026    |    2026    |
|       from small pool |       8    |      14    |    9684    |    9676    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  509602 MB |  509594 MB |
|       from large pool |       0 KB |    2479 MB |  506251 MB |  506251 MB |
|       from small pool |    8131 KB |      11 MB |    3351 MB |    3343 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  509602 MB |  509594 MB |
|       from large pool |       0 KB |    2479 MB |  506251 MB |  506251 MB |
|       from small pool |    8131 KB |      11 MB |    3351 MB |    3343 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   35490 MB |   32186 MB |
|       from large pool |    3290 MB |    5026 MB |   35456 MB |   32166 MB |
|       from small pool |      14 MB |      14 MB |      34 MB |      20 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  428163 MB |  428161 MB |
|       from large pool |       0 KB |    1736 MB |  423941 MB |  423941 MB |
|       from small pool |    2108 KB |       4 MB |    4221 MB |    4219 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   34370    |   34352    |
|       from large pool |       0    |      11    |    3439    |    3439    |
|       from small pool |      18    |      37    |   30931    |   30913    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   34370    |   34352    |
|       from large pool |       0    |      11    |    3439    |    3439    |
|       from small pool |      18    |      37    |   30931    |   30913    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     108    |      91    |
|       from large pool |      10    |      11    |      91    |      81    |
|       from small pool |       7    |       7    |      17    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   15402    |   15394    |
|       from large pool |       0    |       8    |    2661    |    2661    |
|       from small pool |       8    |      14    |   12741    |   12733    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  509602 MB |  509594 MB |
|       from large pool |       0 KB |    2479 MB |  506251 MB |  506251 MB |
|       from small pool |    8131 KB |      11 MB |    3351 MB |    3343 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  509602 MB |  509594 MB |
|       from large pool |       0 KB |    2479 MB |  506251 MB |  506251 MB |
|       from small pool |    8131 KB |      11 MB |    3351 MB |    3343 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   35490 MB |   32186 MB |
|       from large pool |    3290 MB |    5026 MB |   35456 MB |   32166 MB |
|       from small pool |      14 MB |      14 MB |      34 MB |      20 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  428163 MB |  428161 MB |
|       from large pool |       0 KB |    1736 MB |  423941 MB |  423941 MB |
|       from small pool |    2108 KB |       4 MB |    4221 MB |    4219 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   34370    |   34352    |
|       from large pool |       0    |      11    |    3439    |    3439    |
|       from small pool |      18    |      37    |   30931    |   30913    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   34370    |   34352    |
|       from large pool |       0    |      11    |    3439    |    3439    |
|       from small pool |      18    |      37    |   30931    |   30913    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     108    |      91    |
|       from large pool |      10    |      11    |      91    |      81    |
|       from small pool |       7    |       7    |      17    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   15402    |   15394    |
|       from large pool |       0    |       8    |    2661    |    2661    |
|       from small pool |       8    |      14    |   12741    |   12733    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  514001 MB |  513993 MB |
|       from large pool |       0 KB |    2479 MB |  510637 MB |  510637 MB |
|       from small pool |    8131 KB |      11 MB |    3364 MB |    3356 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  514001 MB |  513993 MB |
|       from large pool |       0 KB |    2479 MB |  510637 MB |  510637 MB |
|       from small pool |    8131 KB |      11 MB |    3364 MB |    3356 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |   37226 MB |   32186 MB |
|       from large pool |    5026 MB |    5026 MB |   37192 MB |   32166 MB |
|       from small pool |      14 MB |      14 MB |      34 MB |      20 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  430303 MB |  430301 MB |
|       from large pool |       0 KB |    1736 MB |  426066 MB |  426066 MB |
|       from small pool |    2108 KB |       4 MB |    4236 MB |    4234 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   34468    |   34450    |
|       from large pool |       0    |      11    |    3458    |    3458    |
|       from small pool |      18    |      37    |   31010    |   30992    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   34468    |   34450    |
|       from large pool |       0    |      11    |    3458    |    3458    |
|       from small pool |      18    |      37    |   31010    |   30992    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     109    |      91    |
|       from large pool |      11    |      11    |      92    |      81    |
|       from small pool |       7    |       7    |      17    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   15440    |   15432    |
|       from large pool |       0    |       8    |    2672    |    2672    |
|       from small pool |       8    |      14    |   12768    |   12760    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  632356 MB |  632348 MB |
|       from large pool |       0 KB |    2479 MB |  628193 MB |  628193 MB |
|       from small pool |    8131 KB |      11 MB |    4162 MB |    4154 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  632356 MB |  632348 MB |
|       from large pool |       0 KB |    2479 MB |  628193 MB |  628193 MB |
|       from small pool |    8131 KB |      11 MB |    4162 MB |    4154 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   40520 MB |   37216 MB |
|       from large pool |    3290 MB |    5026 MB |   40482 MB |   37192 MB |
|       from small pool |      14 MB |      14 MB |      38 MB |      24 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  533148 MB |  533146 MB |
|       from large pool |       0 KB |    1736 MB |  527901 MB |  527901 MB |
|       from small pool |    2108 KB |       4 MB |    5246 MB |    5244 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   42696    |   42678    |
|       from large pool |       0    |      11    |    4270    |    4270    |
|       from small pool |      18    |      37    |   38426    |   38408    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   42696    |   42678    |
|       from large pool |       0    |      11    |    4270    |    4270    |
|       from small pool |      18    |      37    |   38426    |   38408    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     121    |     104    |
|       from large pool |      10    |      11    |     102    |      92    |
|       from small pool |       7    |       7    |      19    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   19151    |   19143    |
|       from large pool |       0    |       8    |    3307    |    3307    |
|       from small pool |       8    |      14    |   15844    |   15836    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  632356 MB |  632348 MB |
|       from large pool |       0 KB |    2479 MB |  628193 MB |  628193 MB |
|       from small pool |    8131 KB |      11 MB |    4162 MB |    4154 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  632356 MB |  632348 MB |
|       from large pool |       0 KB |    2479 MB |  628193 MB |  628193 MB |
|       from small pool |    8131 KB |      11 MB |    4162 MB |    4154 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   40520 MB |   37216 MB |
|       from large pool |    3290 MB |    5026 MB |   40482 MB |   37192 MB |
|       from small pool |      14 MB |      14 MB |      38 MB |      24 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  533148 MB |  533146 MB |
|       from large pool |       0 KB |    1736 MB |  527901 MB |  527901 MB |
|       from small pool |    2108 KB |       4 MB |    5246 MB |    5244 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   42696    |   42678    |
|       from large pool |       0    |      11    |    4270    |    4270    |
|       from small pool |      18    |      37    |   38426    |   38408    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   42696    |   42678    |
|       from large pool |       0    |      11    |    4270    |    4270    |
|       from small pool |      18    |      37    |   38426    |   38408    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     121    |     104    |
|       from large pool |      10    |      11    |     102    |      92    |
|       from small pool |       7    |       7    |      19    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   19151    |   19143    |
|       from large pool |       0    |       8    |    3307    |    3307    |
|       from small pool |       8    |      14    |   15844    |   15836    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  636754 MB |  636747 MB |
|       from large pool |       0 KB |    2479 MB |  632578 MB |  632578 MB |
|       from small pool |    8131 KB |      11 MB |    4175 MB |    4168 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  636754 MB |  636747 MB |
|       from large pool |       0 KB |    2479 MB |  632578 MB |  632578 MB |
|       from small pool |    8131 KB |      11 MB |    4175 MB |    4168 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |   42256 MB |   37216 MB |
|       from large pool |    5026 MB |    5026 MB |   42218 MB |   37192 MB |
|       from small pool |      14 MB |      14 MB |      38 MB |      24 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  535288 MB |  535286 MB |
|       from large pool |       0 KB |    1736 MB |  530026 MB |  530026 MB |
|       from small pool |    2108 KB |       4 MB |    5262 MB |    5259 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   42794    |   42776    |
|       from large pool |       0    |      11    |    4289    |    4289    |
|       from small pool |      18    |      37    |   38505    |   38487    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   42794    |   42776    |
|       from large pool |       0    |      11    |    4289    |    4289    |
|       from small pool |      18    |      37    |   38505    |   38487    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     122    |     104    |
|       from large pool |      11    |      11    |     103    |      92    |
|       from small pool |       7    |       7    |      19    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   19190    |   19182    |
|       from large pool |       0    |       8    |    3318    |    3318    |
|       from small pool |       8    |      14    |   15872    |   15864    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  755109 MB |  755101 MB |
|       from large pool |       0 KB |    2479 MB |  750135 MB |  750135 MB |
|       from small pool |    8131 KB |      11 MB |    4974 MB |    4966 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  755109 MB |  755101 MB |
|       from large pool |       0 KB |    2479 MB |  750135 MB |  750135 MB |
|       from small pool |    8131 KB |      11 MB |    4974 MB |    4966 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   45550 MB |   42246 MB |
|       from large pool |    3290 MB |    5026 MB |   45508 MB |   42218 MB |
|       from small pool |      14 MB |      14 MB |      42 MB |      28 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  638133 MB |  638131 MB |
|       from large pool |       0 KB |    1736 MB |  631861 MB |  631861 MB |
|       from small pool |    2108 KB |       4 MB |    6271 MB |    6269 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   51022    |   51004    |
|       from large pool |       0    |      11    |    5101    |    5101    |
|       from small pool |      18    |      37    |   45921    |   45903    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   51022    |   51004    |
|       from large pool |       0    |      11    |    5101    |    5101    |
|       from small pool |      18    |      37    |   45921    |   45903    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     134    |     117    |
|       from large pool |      10    |      11    |     113    |     103    |
|       from small pool |       7    |       7    |      21    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   22882    |   22874    |
|       from large pool |       0    |       8    |    3953    |    3953    |
|       from small pool |       8    |      14    |   18929    |   18921    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  755109 MB |  755101 MB |
|       from large pool |       0 KB |    2479 MB |  750135 MB |  750135 MB |
|       from small pool |    8131 KB |      11 MB |    4974 MB |    4966 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  755109 MB |  755101 MB |
|       from large pool |       0 KB |    2479 MB |  750135 MB |  750135 MB |
|       from small pool |    8131 KB |      11 MB |    4974 MB |    4966 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   45550 MB |   42246 MB |
|       from large pool |    3290 MB |    5026 MB |   45508 MB |   42218 MB |
|       from small pool |      14 MB |      14 MB |      42 MB |      28 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  638133 MB |  638131 MB |
|       from large pool |       0 KB |    1736 MB |  631861 MB |  631861 MB |
|       from small pool |    2108 KB |       4 MB |    6271 MB |    6269 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   51022    |   51004    |
|       from large pool |       0    |      11    |    5101    |    5101    |
|       from small pool |      18    |      37    |   45921    |   45903    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   51022    |   51004    |
|       from large pool |       0    |      11    |    5101    |    5101    |
|       from small pool |      18    |      37    |   45921    |   45903    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     134    |     117    |
|       from large pool |      10    |      11    |     113    |     103    |
|       from small pool |       7    |       7    |      21    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   22882    |   22874    |
|       from large pool |       0    |       8    |    3953    |    3953    |
|       from small pool |       8    |      14    |   18929    |   18921    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |  759508 MB |  759500 MB |
|       from large pool |       0 KB |    2479 MB |  754520 MB |  754520 MB |
|       from small pool |    8131 KB |      11 MB |    4987 MB |    4979 MB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |  759508 MB |  759500 MB |
|       from large pool |       0 KB |    2479 MB |  754520 MB |  754520 MB |
|       from small pool |    8131 KB |      11 MB |    4987 MB |    4979 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |   47286 MB |   42246 MB |
|       from large pool |    5026 MB |    5026 MB |   47244 MB |   42218 MB |
|       from small pool |      14 MB |      14 MB |      42 MB |      28 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  640274 MB |  640272 MB |
|       from large pool |       0 KB |    1736 MB |  633986 MB |  633986 MB |
|       from small pool |    2108 KB |       4 MB |    6287 MB |    6285 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   51120    |   51102    |
|       from large pool |       0    |      11    |    5120    |    5120    |
|       from small pool |      18    |      37    |   46000    |   45982    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   51120    |   51102    |
|       from large pool |       0    |      11    |    5120    |    5120    |
|       from small pool |      18    |      37    |   46000    |   45982    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     135    |     117    |
|       from large pool |      11    |      11    |     114    |     103    |
|       from small pool |       7    |       7    |      21    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   22920    |   22912    |
|       from large pool |       0    |       8    |    3964    |    3964    |
|       from small pool |       8    |      14    |   18956    |   18948    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |     857 GB |     857 GB |
|       from large pool |       0 KB |    2479 MB |     851 GB |     851 GB |
|       from small pool |    8131 KB |      11 MB |       5 GB |       5 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |     857 GB |     857 GB |
|       from large pool |       0 KB |    2479 MB |     851 GB |     851 GB |
|       from small pool |    8131 KB |      11 MB |       5 GB |       5 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   50580 MB |   47276 MB |
|       from large pool |    3290 MB |    5026 MB |   50534 MB |   47244 MB |
|       from small pool |      14 MB |      14 MB |      46 MB |      32 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  743118 MB |  743116 MB |
|       from large pool |       0 KB |    1736 MB |  735821 MB |  735821 MB |
|       from small pool |    2108 KB |       4 MB |    7297 MB |    7295 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   59348    |   59330    |
|       from large pool |       0    |      11    |    5932    |    5932    |
|       from small pool |      18    |      37    |   53416    |   53398    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   59348    |   59330    |
|       from large pool |       0    |      11    |    5932    |    5932    |
|       from small pool |      18    |      37    |   53416    |   53398    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     147    |     130    |
|       from large pool |      10    |      11    |     124    |     114    |
|       from small pool |       7    |       7    |      23    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   26631    |   26623    |
|       from large pool |       0    |       8    |    4599    |    4599    |
|       from small pool |       8    |      14    |   22032    |   22024    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |     857 GB |     857 GB |
|       from large pool |       0 KB |    2479 MB |     851 GB |     851 GB |
|       from small pool |    8131 KB |      11 MB |       5 GB |       5 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |     857 GB |     857 GB |
|       from large pool |       0 KB |    2479 MB |     851 GB |     851 GB |
|       from small pool |    8131 KB |      11 MB |       5 GB |       5 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   50580 MB |   47276 MB |
|       from large pool |    3290 MB |    5026 MB |   50534 MB |   47244 MB |
|       from small pool |      14 MB |      14 MB |      46 MB |      32 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  743118 MB |  743116 MB |
|       from large pool |       0 KB |    1736 MB |  735821 MB |  735821 MB |
|       from small pool |    2108 KB |       4 MB |    7297 MB |    7295 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   59348    |   59330    |
|       from large pool |       0    |      11    |    5932    |    5932    |
|       from small pool |      18    |      37    |   53416    |   53398    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   59348    |   59330    |
|       from large pool |       0    |      11    |    5932    |    5932    |
|       from small pool |      18    |      37    |   53416    |   53398    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     147    |     130    |
|       from large pool |      10    |      11    |     124    |     114    |
|       from small pool |       7    |       7    |      23    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   26631    |   26623    |
|       from large pool |       0    |       8    |    4599    |    4599    |
|       from small pool |       8    |      14    |   22032    |   22024    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |     861 GB |     861 GB |
|       from large pool |       0 KB |    2479 MB |     855 GB |     855 GB |
|       from small pool |    8131 KB |      11 MB |       5 GB |       5 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |     861 GB |     861 GB |
|       from large pool |       0 KB |    2479 MB |     855 GB |     855 GB |
|       from small pool |    8131 KB |      11 MB |       5 GB |       5 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |   52316 MB |   47276 MB |
|       from large pool |    5026 MB |    5026 MB |   52270 MB |   47244 MB |
|       from small pool |      14 MB |      14 MB |      46 MB |      32 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |  745259 MB |  745257 MB |
|       from large pool |       0 KB |    1736 MB |  737946 MB |  737946 MB |
|       from small pool |    2108 KB |       4 MB |    7312 MB |    7310 MB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   59446    |   59428    |
|       from large pool |       0    |      11    |    5951    |    5951    |
|       from small pool |      18    |      37    |   53495    |   53477    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   59446    |   59428    |
|       from large pool |       0    |      11    |    5951    |    5951    |
|       from small pool |      18    |      37    |   53495    |   53477    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     148    |     130    |
|       from large pool |      11    |      11    |     125    |     114    |
|       from small pool |       7    |       7    |      23    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   26670    |   26662    |
|       from large pool |       0    |       8    |    4610    |    4610    |
|       from small pool |       8    |      14    |   22060    |   22052    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |     977 GB |     977 GB |
|       from large pool |       0 KB |    2479 MB |     970 GB |     970 GB |
|       from small pool |    8131 KB |      11 MB |       6 GB |       6 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |     977 GB |     977 GB |
|       from large pool |       0 KB |    2479 MB |     970 GB |     970 GB |
|       from small pool |    8131 KB |      11 MB |       6 GB |       6 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   55610 MB |   52306 MB |
|       from large pool |    3290 MB |    5026 MB |   55560 MB |   52270 MB |
|       from small pool |      14 MB |      14 MB |      50 MB |      36 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |     828 GB |     828 GB |
|       from large pool |       0 KB |    1736 MB |     820 GB |     820 GB |
|       from small pool |    2108 KB |       4 MB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   67674    |   67656    |
|       from large pool |       0    |      11    |    6763    |    6763    |
|       from small pool |      18    |      37    |   60911    |   60893    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   67674    |   67656    |
|       from large pool |       0    |      11    |    6763    |    6763    |
|       from small pool |      18    |      37    |   60911    |   60893    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     160    |     143    |
|       from large pool |      10    |      11    |     135    |     125    |
|       from small pool |       7    |       7    |      25    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   30362    |   30354    |
|       from large pool |       0    |       8    |    5245    |    5245    |
|       from small pool |       8    |      14    |   25117    |   25109    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |     977 GB |     977 GB |
|       from large pool |       0 KB |    2479 MB |     970 GB |     970 GB |
|       from small pool |    8131 KB |      11 MB |       6 GB |       6 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |     977 GB |     977 GB |
|       from large pool |       0 KB |    2479 MB |     970 GB |     970 GB |
|       from small pool |    8131 KB |      11 MB |       6 GB |       6 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   55610 MB |   52306 MB |
|       from large pool |    3290 MB |    5026 MB |   55560 MB |   52270 MB |
|       from small pool |      14 MB |      14 MB |      50 MB |      36 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |     828 GB |     828 GB |
|       from large pool |       0 KB |    1736 MB |     820 GB |     820 GB |
|       from small pool |    2108 KB |       4 MB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   67674    |   67656    |
|       from large pool |       0    |      11    |    6763    |    6763    |
|       from small pool |      18    |      37    |   60911    |   60893    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   67674    |   67656    |
|       from large pool |       0    |      11    |    6763    |    6763    |
|       from small pool |      18    |      37    |   60911    |   60893    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     160    |     143    |
|       from large pool |      10    |      11    |     135    |     125    |
|       from small pool |       7    |       7    |      25    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   30362    |   30354    |
|       from large pool |       0    |       8    |    5245    |    5245    |
|       from small pool |       8    |      14    |   25117    |   25109    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |     981 GB |     981 GB |
|       from large pool |       0 KB |    2479 MB |     975 GB |     975 GB |
|       from small pool |    8131 KB |      11 MB |       6 GB |       6 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |     981 GB |     981 GB |
|       from large pool |       0 KB |    2479 MB |     975 GB |     975 GB |
|       from small pool |    8131 KB |      11 MB |       6 GB |       6 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |   57346 MB |   52306 MB |
|       from large pool |    5026 MB |    5026 MB |   57296 MB |   52270 MB |
|       from small pool |      14 MB |      14 MB |      50 MB |      36 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |     830 GB |     830 GB |
|       from large pool |       0 KB |    1736 MB |     822 GB |     822 GB |
|       from small pool |    2108 KB |       4 MB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   67772    |   67754    |
|       from large pool |       0    |      11    |    6782    |    6782    |
|       from small pool |      18    |      37    |   60990    |   60972    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   67772    |   67754    |
|       from large pool |       0    |      11    |    6782    |    6782    |
|       from small pool |      18    |      37    |   60990    |   60972    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     161    |     143    |
|       from large pool |      11    |      11    |     136    |     125    |
|       from small pool |       7    |       7    |      25    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   30400    |   30392    |
|       from large pool |       0    |       8    |    5256    |    5256    |
|       from small pool |       8    |      14    |   25144    |   25136    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1097 GB |    1097 GB |
|       from large pool |       0 KB |    2479 MB |    1089 GB |    1089 GB |
|       from small pool |    8131 KB |      11 MB |       7 GB |       7 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1097 GB |    1097 GB |
|       from large pool |       0 KB |    2479 MB |    1089 GB |    1089 GB |
|       from small pool |    8131 KB |      11 MB |       7 GB |       7 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   60640 MB |   57336 MB |
|       from large pool |    3290 MB |    5026 MB |   60586 MB |   57296 MB |
|       from small pool |      14 MB |      14 MB |      54 MB |      40 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |     930 GB |     930 GB |
|       from large pool |       0 KB |    1736 MB |     921 GB |     921 GB |
|       from small pool |    2108 KB |       4 MB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   76000    |   75982    |
|       from large pool |       0    |      11    |    7594    |    7594    |
|       from small pool |      18    |      37    |   68406    |   68388    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   76000    |   75982    |
|       from large pool |       0    |      11    |    7594    |    7594    |
|       from small pool |      18    |      37    |   68406    |   68388    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     173    |     156    |
|       from large pool |      10    |      11    |     146    |     136    |
|       from small pool |       7    |       7    |      27    |      20    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   34111    |   34103    |
|       from large pool |       0    |       8    |    5891    |    5891    |
|       from small pool |       8    |      14    |   28220    |   28212    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1097 GB |    1097 GB |
|       from large pool |       0 KB |    2479 MB |    1089 GB |    1089 GB |
|       from small pool |    8131 KB |      11 MB |       7 GB |       7 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1097 GB |    1097 GB |
|       from large pool |       0 KB |    2479 MB |    1089 GB |    1089 GB |
|       from small pool |    8131 KB |      11 MB |       7 GB |       7 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   60640 MB |   57336 MB |
|       from large pool |    3290 MB |    5026 MB |   60586 MB |   57296 MB |
|       from small pool |      14 MB |      14 MB |      54 MB |      40 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |     930 GB |     930 GB |
|       from large pool |       0 KB |    1736 MB |     921 GB |     921 GB |
|       from small pool |    2108 KB |       4 MB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   76000    |   75982    |
|       from large pool |       0    |      11    |    7594    |    7594    |
|       from small pool |      18    |      37    |   68406    |   68388    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   76000    |   75982    |
|       from large pool |       0    |      11    |    7594    |    7594    |
|       from small pool |      18    |      37    |   68406    |   68388    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     173    |     156    |
|       from large pool |      10    |      11    |     146    |     136    |
|       from small pool |       7    |       7    |      27    |      20    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   34111    |   34103    |
|       from large pool |       0    |       8    |    5891    |    5891    |
|       from small pool |       8    |      14    |   28220    |   28212    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1101 GB |    1101 GB |
|       from large pool |       0 KB |    2479 MB |    1094 GB |    1094 GB |
|       from small pool |    8131 KB |      11 MB |       7 GB |       7 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1101 GB |    1101 GB |
|       from large pool |       0 KB |    2479 MB |    1094 GB |    1094 GB |
|       from small pool |    8131 KB |      11 MB |       7 GB |       7 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |   62376 MB |   57336 MB |
|       from large pool |    5026 MB |    5026 MB |   62322 MB |   57296 MB |
|       from small pool |      14 MB |      14 MB |      54 MB |      40 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |     932 GB |     932 GB |
|       from large pool |       0 KB |    1736 MB |     923 GB |     923 GB |
|       from small pool |    2108 KB |       4 MB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   76098    |   76080    |
|       from large pool |       0    |      11    |    7613    |    7613    |
|       from small pool |      18    |      37    |   68485    |   68467    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   76098    |   76080    |
|       from large pool |       0    |      11    |    7613    |    7613    |
|       from small pool |      18    |      37    |   68485    |   68467    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     174    |     156    |
|       from large pool |      11    |      11    |     147    |     136    |
|       from small pool |       7    |       7    |      27    |      20    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   34150    |   34142    |
|       from large pool |       0    |       8    |    5902    |    5902    |
|       from small pool |       8    |      14    |   28248    |   28240    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1216 GB |    1216 GB |
|       from large pool |       0 KB |    2479 MB |    1208 GB |    1208 GB |
|       from small pool |    8131 KB |      11 MB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1216 GB |    1216 GB |
|       from large pool |       0 KB |    2479 MB |    1208 GB |    1208 GB |
|       from small pool |    8131 KB |      11 MB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   65670 MB |   62366 MB |
|       from large pool |    3290 MB |    5026 MB |   65612 MB |   62322 MB |
|       from small pool |      14 MB |      14 MB |      58 MB |      44 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1033 GB |    1033 GB |
|       from large pool |       0 KB |    1736 MB |    1023 GB |    1023 GB |
|       from small pool |    2108 KB |       4 MB |      10 GB |      10 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   84326    |   84308    |
|       from large pool |       0    |      11    |    8425    |    8425    |
|       from small pool |      18    |      37    |   75901    |   75883    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   84326    |   84308    |
|       from large pool |       0    |      11    |    8425    |    8425    |
|       from small pool |      18    |      37    |   75901    |   75883    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     186    |     169    |
|       from large pool |      10    |      11    |     157    |     147    |
|       from small pool |       7    |       7    |      29    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   37842    |   37834    |
|       from large pool |       0    |       8    |    6537    |    6537    |
|       from small pool |       8    |      14    |   31305    |   31297    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1216 GB |    1216 GB |
|       from large pool |       0 KB |    2479 MB |    1208 GB |    1208 GB |
|       from small pool |    8131 KB |      11 MB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1216 GB |    1216 GB |
|       from large pool |       0 KB |    2479 MB |    1208 GB |    1208 GB |
|       from small pool |    8131 KB |      11 MB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   65670 MB |   62366 MB |
|       from large pool |    3290 MB |    5026 MB |   65612 MB |   62322 MB |
|       from small pool |      14 MB |      14 MB |      58 MB |      44 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1033 GB |    1033 GB |
|       from large pool |       0 KB |    1736 MB |    1023 GB |    1023 GB |
|       from small pool |    2108 KB |       4 MB |      10 GB |      10 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   84326    |   84308    |
|       from large pool |       0    |      11    |    8425    |    8425    |
|       from small pool |      18    |      37    |   75901    |   75883    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   84326    |   84308    |
|       from large pool |       0    |      11    |    8425    |    8425    |
|       from small pool |      18    |      37    |   75901    |   75883    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     186    |     169    |
|       from large pool |      10    |      11    |     157    |     147    |
|       from small pool |       7    |       7    |      29    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   37842    |   37834    |
|       from large pool |       0    |       8    |    6537    |    6537    |
|       from small pool |       8    |      14    |   31305    |   31297    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1221 GB |    1221 GB |
|       from large pool |       0 KB |    2479 MB |    1213 GB |    1213 GB |
|       from small pool |    8131 KB |      11 MB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1221 GB |    1221 GB |
|       from large pool |       0 KB |    2479 MB |    1213 GB |    1213 GB |
|       from small pool |    8131 KB |      11 MB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |   67406 MB |   62366 MB |
|       from large pool |    5026 MB |    5026 MB |   67348 MB |   62322 MB |
|       from small pool |      14 MB |      14 MB |      58 MB |      44 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1035 GB |    1035 GB |
|       from large pool |       0 KB |    1736 MB |    1025 GB |    1025 GB |
|       from small pool |    2108 KB |       4 MB |      10 GB |      10 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   84424    |   84406    |
|       from large pool |       0    |      11    |    8444    |    8444    |
|       from small pool |      18    |      37    |   75980    |   75962    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   84424    |   84406    |
|       from large pool |       0    |      11    |    8444    |    8444    |
|       from small pool |      18    |      37    |   75980    |   75962    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     187    |     169    |
|       from large pool |      11    |      11    |     158    |     147    |
|       from small pool |       7    |       7    |      29    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   37880    |   37872    |
|       from large pool |       0    |       8    |    6548    |    6548    |
|       from small pool |       8    |      14    |   31332    |   31324    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1336 GB |    1336 GB |
|       from large pool |       0 KB |    2479 MB |    1327 GB |    1327 GB |
|       from small pool |    8131 KB |      11 MB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1336 GB |    1336 GB |
|       from large pool |       0 KB |    2479 MB |    1327 GB |    1327 GB |
|       from small pool |    8131 KB |      11 MB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   70700 MB |   67396 MB |
|       from large pool |    3290 MB |    5026 MB |   70638 MB |   67348 MB |
|       from small pool |      14 MB |      14 MB |      62 MB |      48 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1135 GB |    1135 GB |
|       from large pool |       0 KB |    1736 MB |    1124 GB |    1124 GB |
|       from small pool |    2108 KB |       4 MB |      11 GB |      11 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   92652    |   92634    |
|       from large pool |       0    |      11    |    9256    |    9256    |
|       from small pool |      18    |      37    |   83396    |   83378    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   92652    |   92634    |
|       from large pool |       0    |      11    |    9256    |    9256    |
|       from small pool |      18    |      37    |   83396    |   83378    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     199    |     182    |
|       from large pool |      10    |      11    |     168    |     158    |
|       from small pool |       7    |       7    |      31    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   41591    |   41583    |
|       from large pool |       0    |       8    |    7183    |    7183    |
|       from small pool |       8    |      14    |   34408    |   34400    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1336 GB |    1336 GB |
|       from large pool |       0 KB |    2479 MB |    1327 GB |    1327 GB |
|       from small pool |    8131 KB |      11 MB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1336 GB |    1336 GB |
|       from large pool |       0 KB |    2479 MB |    1327 GB |    1327 GB |
|       from small pool |    8131 KB |      11 MB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   70700 MB |   67396 MB |
|       from large pool |    3290 MB |    5026 MB |   70638 MB |   67348 MB |
|       from small pool |      14 MB |      14 MB |      62 MB |      48 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1135 GB |    1135 GB |
|       from large pool |       0 KB |    1736 MB |    1124 GB |    1124 GB |
|       from small pool |    2108 KB |       4 MB |      11 GB |      11 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   92652    |   92634    |
|       from large pool |       0    |      11    |    9256    |    9256    |
|       from small pool |      18    |      37    |   83396    |   83378    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   92652    |   92634    |
|       from large pool |       0    |      11    |    9256    |    9256    |
|       from small pool |      18    |      37    |   83396    |   83378    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     199    |     182    |
|       from large pool |      10    |      11    |     168    |     158    |
|       from small pool |       7    |       7    |      31    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   41591    |   41583    |
|       from large pool |       0    |       8    |    7183    |    7183    |
|       from small pool |       8    |      14    |   34408    |   34400    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1341 GB |    1341 GB |
|       from large pool |       0 KB |    2479 MB |    1332 GB |    1332 GB |
|       from small pool |    8131 KB |      11 MB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1341 GB |    1341 GB |
|       from large pool |       0 KB |    2479 MB |    1332 GB |    1332 GB |
|       from small pool |    8131 KB |      11 MB |       8 GB |       8 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |   72436 MB |   67396 MB |
|       from large pool |    5026 MB |    5026 MB |   72374 MB |   67348 MB |
|       from small pool |      14 MB |      14 MB |      62 MB |      48 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1137 GB |    1137 GB |
|       from large pool |       0 KB |    1736 MB |    1126 GB |    1126 GB |
|       from small pool |    2108 KB |       4 MB |      11 GB |      11 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |   92750    |   92732    |
|       from large pool |       0    |      11    |    9275    |    9275    |
|       from small pool |      18    |      37    |   83475    |   83457    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |   92750    |   92732    |
|       from large pool |       0    |      11    |    9275    |    9275    |
|       from small pool |      18    |      37    |   83475    |   83457    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     200    |     182    |
|       from large pool |      11    |      11    |     169    |     158    |
|       from small pool |       7    |       7    |      31    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   41630    |   41622    |
|       from large pool |       0    |       8    |    7194    |    7194    |
|       from small pool |       8    |      14    |   34436    |   34428    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1456 GB |    1456 GB |
|       from large pool |       0 KB |    2479 MB |    1447 GB |    1447 GB |
|       from small pool |    8131 KB |      11 MB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1456 GB |    1456 GB |
|       from large pool |       0 KB |    2479 MB |    1447 GB |    1447 GB |
|       from small pool |    8131 KB |      11 MB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   75730 MB |   72426 MB |
|       from large pool |    3290 MB |    5026 MB |   75664 MB |   72374 MB |
|       from small pool |      14 MB |      14 MB |      66 MB |      52 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1238 GB |    1238 GB |
|       from large pool |       0 KB |    1736 MB |    1226 GB |    1226 GB |
|       from small pool |    2108 KB |       4 MB |      12 GB |      12 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  100978    |  100960    |
|       from large pool |       0    |      11    |   10087    |   10087    |
|       from small pool |      18    |      37    |   90891    |   90873    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  100978    |  100960    |
|       from large pool |       0    |      11    |   10087    |   10087    |
|       from small pool |      18    |      37    |   90891    |   90873    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     212    |     195    |
|       from large pool |      10    |      11    |     179    |     169    |
|       from small pool |       7    |       7    |      33    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   45322    |   45314    |
|       from large pool |       0    |       8    |    7829    |    7829    |
|       from small pool |       8    |      14    |   37493    |   37485    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1456 GB |    1456 GB |
|       from large pool |       0 KB |    2479 MB |    1447 GB |    1447 GB |
|       from small pool |    8131 KB |      11 MB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1456 GB |    1456 GB |
|       from large pool |       0 KB |    2479 MB |    1447 GB |    1447 GB |
|       from small pool |    8131 KB |      11 MB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   75730 MB |   72426 MB |
|       from large pool |    3290 MB |    5026 MB |   75664 MB |   72374 MB |
|       from small pool |      14 MB |      14 MB |      66 MB |      52 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1238 GB |    1238 GB |
|       from large pool |       0 KB |    1736 MB |    1226 GB |    1226 GB |
|       from small pool |    2108 KB |       4 MB |      12 GB |      12 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  100978    |  100960    |
|       from large pool |       0    |      11    |   10087    |   10087    |
|       from small pool |      18    |      37    |   90891    |   90873    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  100978    |  100960    |
|       from large pool |       0    |      11    |   10087    |   10087    |
|       from small pool |      18    |      37    |   90891    |   90873    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     212    |     195    |
|       from large pool |      10    |      11    |     179    |     169    |
|       from small pool |       7    |       7    |      33    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   45322    |   45314    |
|       from large pool |       0    |       8    |    7829    |    7829    |
|       from small pool |       8    |      14    |   37493    |   37485    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1460 GB |    1460 GB |
|       from large pool |       0 KB |    2479 MB |    1451 GB |    1451 GB |
|       from small pool |    8131 KB |      11 MB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1460 GB |    1460 GB |
|       from large pool |       0 KB |    2479 MB |    1451 GB |    1451 GB |
|       from small pool |    8131 KB |      11 MB |       9 GB |       9 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |   77466 MB |   72426 MB |
|       from large pool |    5026 MB |    5026 MB |   77400 MB |   72374 MB |
|       from small pool |      14 MB |      14 MB |      66 MB |      52 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1240 GB |    1240 GB |
|       from large pool |       0 KB |    1736 MB |    1228 GB |    1228 GB |
|       from small pool |    2108 KB |       4 MB |      12 GB |      12 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  101076    |  101058    |
|       from large pool |       0    |      11    |   10106    |   10106    |
|       from small pool |      18    |      37    |   90970    |   90952    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  101076    |  101058    |
|       from large pool |       0    |      11    |   10106    |   10106    |
|       from small pool |      18    |      37    |   90970    |   90952    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     213    |     195    |
|       from large pool |      11    |      11    |     180    |     169    |
|       from small pool |       7    |       7    |      33    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   45360    |   45352    |
|       from large pool |       0    |       8    |    7840    |    7840    |
|       from small pool |       8    |      14    |   37520    |   37512    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1576 GB |    1576 GB |
|       from large pool |       0 KB |    2479 MB |    1566 GB |    1566 GB |
|       from small pool |    8131 KB |      11 MB |      10 GB |      10 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1576 GB |    1576 GB |
|       from large pool |       0 KB |    2479 MB |    1566 GB |    1566 GB |
|       from small pool |    8131 KB |      11 MB |      10 GB |      10 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   80760 MB |   77456 MB |
|       from large pool |    3290 MB |    5026 MB |   80690 MB |   77400 MB |
|       from small pool |      14 MB |      14 MB |      70 MB |      56 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1340 GB |    1340 GB |
|       from large pool |       0 KB |    1736 MB |    1327 GB |    1327 GB |
|       from small pool |    2108 KB |       4 MB |      13 GB |      13 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  109304    |  109286    |
|       from large pool |       0    |      11    |   10918    |   10918    |
|       from small pool |      18    |      37    |   98386    |   98368    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  109304    |  109286    |
|       from large pool |       0    |      11    |   10918    |   10918    |
|       from small pool |      18    |      37    |   98386    |   98368    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     225    |     208    |
|       from large pool |      10    |      11    |     190    |     180    |
|       from small pool |       7    |       7    |      35    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   49071    |   49063    |
|       from large pool |       0    |       8    |    8475    |    8475    |
|       from small pool |       8    |      14    |   40596    |   40588    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1576 GB |    1576 GB |
|       from large pool |       0 KB |    2479 MB |    1566 GB |    1566 GB |
|       from small pool |    8131 KB |      11 MB |      10 GB |      10 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1576 GB |    1576 GB |
|       from large pool |       0 KB |    2479 MB |    1566 GB |    1566 GB |
|       from small pool |    8131 KB |      11 MB |      10 GB |      10 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   80760 MB |   77456 MB |
|       from large pool |    3290 MB |    5026 MB |   80690 MB |   77400 MB |
|       from small pool |      14 MB |      14 MB |      70 MB |      56 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1340 GB |    1340 GB |
|       from large pool |       0 KB |    1736 MB |    1327 GB |    1327 GB |
|       from small pool |    2108 KB |       4 MB |      13 GB |      13 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  109304    |  109286    |
|       from large pool |       0    |      11    |   10918    |   10918    |
|       from small pool |      18    |      37    |   98386    |   98368    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  109304    |  109286    |
|       from large pool |       0    |      11    |   10918    |   10918    |
|       from small pool |      18    |      37    |   98386    |   98368    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     225    |     208    |
|       from large pool |      10    |      11    |     190    |     180    |
|       from small pool |       7    |       7    |      35    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   49071    |   49063    |
|       from large pool |       0    |       8    |    8475    |    8475    |
|       from small pool |       8    |      14    |   40596    |   40588    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1580 GB |    1580 GB |
|       from large pool |       0 KB |    2479 MB |    1570 GB |    1570 GB |
|       from small pool |    8131 KB |      11 MB |      10 GB |      10 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1580 GB |    1580 GB |
|       from large pool |       0 KB |    2479 MB |    1570 GB |    1570 GB |
|       from small pool |    8131 KB |      11 MB |      10 GB |      10 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |   82496 MB |   77456 MB |
|       from large pool |    5026 MB |    5026 MB |   82426 MB |   77400 MB |
|       from small pool |      14 MB |      14 MB |      70 MB |      56 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1342 GB |    1342 GB |
|       from large pool |       0 KB |    1736 MB |    1329 GB |    1329 GB |
|       from small pool |    2108 KB |       4 MB |      13 GB |      13 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  109402    |  109384    |
|       from large pool |       0    |      11    |   10937    |   10937    |
|       from small pool |      18    |      37    |   98465    |   98447    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  109402    |  109384    |
|       from large pool |       0    |      11    |   10937    |   10937    |
|       from small pool |      18    |      37    |   98465    |   98447    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     226    |     208    |
|       from large pool |      11    |      11    |     191    |     180    |
|       from small pool |       7    |       7    |      35    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   49110    |   49102    |
|       from large pool |       0    |       8    |    8486    |    8486    |
|       from small pool |       8    |      14    |   40624    |   40616    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1696 GB |    1696 GB |
|       from large pool |       0 KB |    2479 MB |    1685 GB |    1685 GB |
|       from small pool |    8131 KB |      11 MB |      11 GB |      11 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1696 GB |    1696 GB |
|       from large pool |       0 KB |    2479 MB |    1685 GB |    1685 GB |
|       from small pool |    8131 KB |      11 MB |      11 GB |      11 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   85790 MB |   82486 MB |
|       from large pool |    3290 MB |    5026 MB |   85716 MB |   82426 MB |
|       from small pool |      14 MB |      14 MB |      74 MB |      60 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1443 GB |    1443 GB |
|       from large pool |       0 KB |    1736 MB |    1429 GB |    1429 GB |
|       from small pool |    2108 KB |       4 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  117630    |  117612    |
|       from large pool |       0    |      11    |   11749    |   11749    |
|       from small pool |      18    |      37    |  105881    |  105863    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  117630    |  117612    |
|       from large pool |       0    |      11    |   11749    |   11749    |
|       from small pool |      18    |      37    |  105881    |  105863    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     238    |     221    |
|       from large pool |      10    |      11    |     201    |     191    |
|       from small pool |       7    |       7    |      37    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   52802    |   52794    |
|       from large pool |       0    |       8    |    9121    |    9121    |
|       from small pool |       8    |      14    |   43681    |   43673    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1696 GB |    1696 GB |
|       from large pool |       0 KB |    2479 MB |    1685 GB |    1685 GB |
|       from small pool |    8131 KB |      11 MB |      11 GB |      11 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1696 GB |    1696 GB |
|       from large pool |       0 KB |    2479 MB |    1685 GB |    1685 GB |
|       from small pool |    8131 KB |      11 MB |      11 GB |      11 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   85790 MB |   82486 MB |
|       from large pool |    3290 MB |    5026 MB |   85716 MB |   82426 MB |
|       from small pool |      14 MB |      14 MB |      74 MB |      60 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1443 GB |    1443 GB |
|       from large pool |       0 KB |    1736 MB |    1429 GB |    1429 GB |
|       from small pool |    2108 KB |       4 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  117630    |  117612    |
|       from large pool |       0    |      11    |   11749    |   11749    |
|       from small pool |      18    |      37    |  105881    |  105863    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  117630    |  117612    |
|       from large pool |       0    |      11    |   11749    |   11749    |
|       from small pool |      18    |      37    |  105881    |  105863    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     238    |     221    |
|       from large pool |      10    |      11    |     201    |     191    |
|       from small pool |       7    |       7    |      37    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   52802    |   52794    |
|       from large pool |       0    |       8    |    9121    |    9121    |
|       from small pool |       8    |      14    |   43681    |   43673    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1700 GB |    1700 GB |
|       from large pool |       0 KB |    2479 MB |    1689 GB |    1689 GB |
|       from small pool |    8131 KB |      11 MB |      11 GB |      11 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1700 GB |    1700 GB |
|       from large pool |       0 KB |    2479 MB |    1689 GB |    1689 GB |
|       from small pool |    8131 KB |      11 MB |      11 GB |      11 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |   87526 MB |   82486 MB |
|       from large pool |    5026 MB |    5026 MB |   87452 MB |   82426 MB |
|       from small pool |      14 MB |      14 MB |      74 MB |      60 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1445 GB |    1445 GB |
|       from large pool |       0 KB |    1736 MB |    1431 GB |    1431 GB |
|       from small pool |    2108 KB |       4 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  117728    |  117710    |
|       from large pool |       0    |      11    |   11768    |   11768    |
|       from small pool |      18    |      37    |  105960    |  105942    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  117728    |  117710    |
|       from large pool |       0    |      11    |   11768    |   11768    |
|       from small pool |      18    |      37    |  105960    |  105942    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     239    |     221    |
|       from large pool |      11    |      11    |     202    |     191    |
|       from small pool |       7    |       7    |      37    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   52840    |   52832    |
|       from large pool |       0    |       8    |    9132    |    9132    |
|       from small pool |       8    |      14    |   43708    |   43700    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1816 GB |    1816 GB |
|       from large pool |       0 KB |    2479 MB |    1804 GB |    1804 GB |
|       from small pool |    8131 KB |      11 MB |      11 GB |      11 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1816 GB |    1816 GB |
|       from large pool |       0 KB |    2479 MB |    1804 GB |    1804 GB |
|       from small pool |    8131 KB |      11 MB |      11 GB |      11 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   90820 MB |   87516 MB |
|       from large pool |    3290 MB |    5026 MB |   90742 MB |   87452 MB |
|       from small pool |      14 MB |      14 MB |      78 MB |      64 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1545 GB |    1545 GB |
|       from large pool |       0 KB |    1736 MB |    1530 GB |    1530 GB |
|       from small pool |    2108 KB |       4 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  125956    |  125938    |
|       from large pool |       0    |      11    |   12580    |   12580    |
|       from small pool |      18    |      37    |  113376    |  113358    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  125956    |  125938    |
|       from large pool |       0    |      11    |   12580    |   12580    |
|       from small pool |      18    |      37    |  113376    |  113358    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     251    |     234    |
|       from large pool |      10    |      11    |     212    |     202    |
|       from small pool |       7    |       7    |      39    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   56551    |   56543    |
|       from large pool |       0    |       8    |    9767    |    9767    |
|       from small pool |       8    |      14    |   46784    |   46776    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1816 GB |    1816 GB |
|       from large pool |       0 KB |    2479 MB |    1804 GB |    1804 GB |
|       from small pool |    8131 KB |      11 MB |      11 GB |      11 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1816 GB |    1816 GB |
|       from large pool |       0 KB |    2479 MB |    1804 GB |    1804 GB |
|       from small pool |    8131 KB |      11 MB |      11 GB |      11 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   90820 MB |   87516 MB |
|       from large pool |    3290 MB |    5026 MB |   90742 MB |   87452 MB |
|       from small pool |      14 MB |      14 MB |      78 MB |      64 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1545 GB |    1545 GB |
|       from large pool |       0 KB |    1736 MB |    1530 GB |    1530 GB |
|       from small pool |    2108 KB |       4 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  125956    |  125938    |
|       from large pool |       0    |      11    |   12580    |   12580    |
|       from small pool |      18    |      37    |  113376    |  113358    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  125956    |  125938    |
|       from large pool |       0    |      11    |   12580    |   12580    |
|       from small pool |      18    |      37    |  113376    |  113358    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     251    |     234    |
|       from large pool |      10    |      11    |     212    |     202    |
|       from small pool |       7    |       7    |      39    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   56551    |   56543    |
|       from large pool |       0    |       8    |    9767    |    9767    |
|       from small pool |       8    |      14    |   46784    |   46776    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1820 GB |    1820 GB |
|       from large pool |       0 KB |    2479 MB |    1808 GB |    1808 GB |
|       from small pool |    8131 KB |      11 MB |      12 GB |      11 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1820 GB |    1820 GB |
|       from large pool |       0 KB |    2479 MB |    1808 GB |    1808 GB |
|       from small pool |    8131 KB |      11 MB |      12 GB |      11 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |   92556 MB |   87516 MB |
|       from large pool |    5026 MB |    5026 MB |   92478 MB |   87452 MB |
|       from small pool |      14 MB |      14 MB |      78 MB |      64 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1547 GB |    1547 GB |
|       from large pool |       0 KB |    1736 MB |    1532 GB |    1532 GB |
|       from small pool |    2108 KB |       4 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  126054    |  126036    |
|       from large pool |       0    |      11    |   12599    |   12599    |
|       from small pool |      18    |      37    |  113455    |  113437    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  126054    |  126036    |
|       from large pool |       0    |      11    |   12599    |   12599    |
|       from small pool |      18    |      37    |  113455    |  113437    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     252    |     234    |
|       from large pool |      11    |      11    |     213    |     202    |
|       from small pool |       7    |       7    |      39    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   56590    |   56582    |
|       from large pool |       0    |       8    |    9778    |    9778    |
|       from small pool |       8    |      14    |   46812    |   46804    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1936 GB |    1936 GB |
|       from large pool |       0 KB |    2479 MB |    1923 GB |    1923 GB |
|       from small pool |    8131 KB |      11 MB |      12 GB |      12 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1936 GB |    1936 GB |
|       from large pool |       0 KB |    2479 MB |    1923 GB |    1923 GB |
|       from small pool |    8131 KB |      11 MB |      12 GB |      12 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   95850 MB |   92546 MB |
|       from large pool |    3290 MB |    5026 MB |   95768 MB |   92478 MB |
|       from small pool |      14 MB |      14 MB |      82 MB |      68 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1648 GB |    1648 GB |
|       from large pool |       0 KB |    1736 MB |    1632 GB |    1632 GB |
|       from small pool |    2108 KB |       4 MB |      16 GB |      16 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  134282    |  134264    |
|       from large pool |       0    |      11    |   13411    |   13411    |
|       from small pool |      18    |      37    |  120871    |  120853    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  134282    |  134264    |
|       from large pool |       0    |      11    |   13411    |   13411    |
|       from small pool |      18    |      37    |  120871    |  120853    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     264    |     247    |
|       from large pool |      10    |      11    |     223    |     213    |
|       from small pool |       7    |       7    |      41    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   60282    |   60274    |
|       from large pool |       0    |       8    |   10413    |   10413    |
|       from small pool |       8    |      14    |   49869    |   49861    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1936 GB |    1936 GB |
|       from large pool |       0 KB |    2479 MB |    1923 GB |    1923 GB |
|       from small pool |    8131 KB |      11 MB |      12 GB |      12 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1936 GB |    1936 GB |
|       from large pool |       0 KB |    2479 MB |    1923 GB |    1923 GB |
|       from small pool |    8131 KB |      11 MB |      12 GB |      12 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |   95850 MB |   92546 MB |
|       from large pool |    3290 MB |    5026 MB |   95768 MB |   92478 MB |
|       from small pool |      14 MB |      14 MB |      82 MB |      68 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1648 GB |    1648 GB |
|       from large pool |       0 KB |    1736 MB |    1632 GB |    1632 GB |
|       from small pool |    2108 KB |       4 MB |      16 GB |      16 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  134282    |  134264    |
|       from large pool |       0    |      11    |   13411    |   13411    |
|       from small pool |      18    |      37    |  120871    |  120853    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  134282    |  134264    |
|       from large pool |       0    |      11    |   13411    |   13411    |
|       from small pool |      18    |      37    |  120871    |  120853    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     264    |     247    |
|       from large pool |      10    |      11    |     223    |     213    |
|       from small pool |       7    |       7    |      41    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   60282    |   60274    |
|       from large pool |       0    |       8    |   10413    |   10413    |
|       from small pool |       8    |      14    |   49869    |   49861    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    1940 GB |    1940 GB |
|       from large pool |       0 KB |    2479 MB |    1927 GB |    1927 GB |
|       from small pool |    8131 KB |      11 MB |      12 GB |      12 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    1940 GB |    1940 GB |
|       from large pool |       0 KB |    2479 MB |    1927 GB |    1927 GB |
|       from small pool |    8131 KB |      11 MB |      12 GB |      12 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |   97586 MB |   92546 MB |
|       from large pool |    5026 MB |    5026 MB |   97504 MB |   92478 MB |
|       from small pool |      14 MB |      14 MB |      82 MB |      68 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1650 GB |    1650 GB |
|       from large pool |       0 KB |    1736 MB |    1634 GB |    1634 GB |
|       from small pool |    2108 KB |       4 MB |      16 GB |      16 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  134380    |  134362    |
|       from large pool |       0    |      11    |   13430    |   13430    |
|       from small pool |      18    |      37    |  120950    |  120932    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  134380    |  134362    |
|       from large pool |       0    |      11    |   13430    |   13430    |
|       from small pool |      18    |      37    |  120950    |  120932    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     265    |     247    |
|       from large pool |      11    |      11    |     224    |     213    |
|       from small pool |       7    |       7    |      41    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   60320    |   60312    |
|       from large pool |       0    |       8    |   10424    |   10424    |
|       from small pool |       8    |      14    |   49896    |   49888    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    2056 GB |    2056 GB |
|       from large pool |       0 KB |    2479 MB |    2042 GB |    2042 GB |
|       from small pool |    8131 KB |      11 MB |      13 GB |      13 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    2056 GB |    2056 GB |
|       from large pool |       0 KB |    2479 MB |    2042 GB |    2042 GB |
|       from small pool |    8131 KB |      11 MB |      13 GB |      13 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |  100880 MB |   97576 MB |
|       from large pool |    3290 MB |    5026 MB |  100794 MB |   97504 MB |
|       from small pool |      14 MB |      14 MB |      86 MB |      72 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1750 GB |    1750 GB |
|       from large pool |       0 KB |    1736 MB |    1733 GB |    1733 GB |
|       from small pool |    2108 KB |       4 MB |      17 GB |      17 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  142608    |  142590    |
|       from large pool |       0    |      11    |   14242    |   14242    |
|       from small pool |      18    |      37    |  128366    |  128348    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  142608    |  142590    |
|       from large pool |       0    |      11    |   14242    |   14242    |
|       from small pool |      18    |      37    |  128366    |  128348    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     277    |     260    |
|       from large pool |      10    |      11    |     234    |     224    |
|       from small pool |       7    |       7    |      43    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   64031    |   64023    |
|       from large pool |       0    |       8    |   11059    |   11059    |
|       from small pool |       8    |      14    |   52972    |   52964    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    2056 GB |    2056 GB |
|       from large pool |       0 KB |    2479 MB |    2042 GB |    2042 GB |
|       from small pool |    8131 KB |      11 MB |      13 GB |      13 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    2056 GB |    2056 GB |
|       from large pool |       0 KB |    2479 MB |    2042 GB |    2042 GB |
|       from small pool |    8131 KB |      11 MB |      13 GB |      13 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |  100880 MB |   97576 MB |
|       from large pool |    3290 MB |    5026 MB |  100794 MB |   97504 MB |
|       from small pool |      14 MB |      14 MB |      86 MB |      72 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1750 GB |    1750 GB |
|       from large pool |       0 KB |    1736 MB |    1733 GB |    1733 GB |
|       from small pool |    2108 KB |       4 MB |      17 GB |      17 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  142608    |  142590    |
|       from large pool |       0    |      11    |   14242    |   14242    |
|       from small pool |      18    |      37    |  128366    |  128348    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  142608    |  142590    |
|       from large pool |       0    |      11    |   14242    |   14242    |
|       from small pool |      18    |      37    |  128366    |  128348    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     277    |     260    |
|       from large pool |      10    |      11    |     234    |     224    |
|       from small pool |       7    |       7    |      43    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   64031    |   64023    |
|       from large pool |       0    |       8    |   11059    |   11059    |
|       from small pool |       8    |      14    |   52972    |   52964    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    2060 GB |    2060 GB |
|       from large pool |       0 KB |    2479 MB |    2046 GB |    2046 GB |
|       from small pool |    8131 KB |      11 MB |      13 GB |      13 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    2060 GB |    2060 GB |
|       from large pool |       0 KB |    2479 MB |    2046 GB |    2046 GB |
|       from small pool |    8131 KB |      11 MB |      13 GB |      13 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |  102616 MB |   97576 MB |
|       from large pool |    5026 MB |    5026 MB |  102530 MB |   97504 MB |
|       from small pool |      14 MB |      14 MB |      86 MB |      72 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1753 GB |    1753 GB |
|       from large pool |       0 KB |    1736 MB |    1735 GB |    1735 GB |
|       from small pool |    2108 KB |       4 MB |      17 GB |      17 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  142706    |  142688    |
|       from large pool |       0    |      11    |   14261    |   14261    |
|       from small pool |      18    |      37    |  128445    |  128427    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  142706    |  142688    |
|       from large pool |       0    |      11    |   14261    |   14261    |
|       from small pool |      18    |      37    |  128445    |  128427    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     278    |     260    |
|       from large pool |      11    |      11    |     235    |     224    |
|       from small pool |       7    |       7    |      43    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   64070    |   64062    |
|       from large pool |       0    |       8    |   11070    |   11070    |
|       from small pool |       8    |      14    |   53000    |   52992    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    2175 GB |    2175 GB |
|       from large pool |       0 KB |    2479 MB |    2161 GB |    2161 GB |
|       from small pool |    8131 KB |      11 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    2175 GB |    2175 GB |
|       from large pool |       0 KB |    2479 MB |    2161 GB |    2161 GB |
|       from small pool |    8131 KB |      11 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |  105910 MB |  102606 MB |
|       from large pool |    3290 MB |    5026 MB |  105820 MB |  102530 MB |
|       from small pool |      14 MB |      14 MB |      90 MB |      76 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1853 GB |    1853 GB |
|       from large pool |       0 KB |    1736 MB |    1835 GB |    1835 GB |
|       from small pool |    2108 KB |       4 MB |      18 GB |      18 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  150934    |  150916    |
|       from large pool |       0    |      11    |   15073    |   15073    |
|       from small pool |      18    |      37    |  135861    |  135843    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  150934    |  150916    |
|       from large pool |       0    |      11    |   15073    |   15073    |
|       from small pool |      18    |      37    |  135861    |  135843    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     290    |     273    |
|       from large pool |      10    |      11    |     245    |     235    |
|       from small pool |       7    |       7    |      45    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   67762    |   67754    |
|       from large pool |       0    |       8    |   11705    |   11705    |
|       from small pool |       8    |      14    |   56057    |   56049    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    2175 GB |    2175 GB |
|       from large pool |       0 KB |    2479 MB |    2161 GB |    2161 GB |
|       from small pool |    8131 KB |      11 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    2175 GB |    2175 GB |
|       from large pool |       0 KB |    2479 MB |    2161 GB |    2161 GB |
|       from small pool |    8131 KB |      11 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |  105910 MB |  102606 MB |
|       from large pool |    3290 MB |    5026 MB |  105820 MB |  102530 MB |
|       from small pool |      14 MB |      14 MB |      90 MB |      76 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1853 GB |    1853 GB |
|       from large pool |       0 KB |    1736 MB |    1835 GB |    1835 GB |
|       from small pool |    2108 KB |       4 MB |      18 GB |      18 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  150934    |  150916    |
|       from large pool |       0    |      11    |   15073    |   15073    |
|       from small pool |      18    |      37    |  135861    |  135843    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  150934    |  150916    |
|       from large pool |       0    |      11    |   15073    |   15073    |
|       from small pool |      18    |      37    |  135861    |  135843    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     290    |     273    |
|       from large pool |      10    |      11    |     245    |     235    |
|       from small pool |       7    |       7    |      45    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   67762    |   67754    |
|       from large pool |       0    |       8    |   11705    |   11705    |
|       from small pool |       8    |      14    |   56057    |   56049    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    2180 GB |    2180 GB |
|       from large pool |       0 KB |    2479 MB |    2165 GB |    2165 GB |
|       from small pool |    8131 KB |      11 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    2180 GB |    2180 GB |
|       from large pool |       0 KB |    2479 MB |    2165 GB |    2165 GB |
|       from small pool |    8131 KB |      11 MB |      14 GB |      14 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |  107646 MB |  102606 MB |
|       from large pool |    5026 MB |    5026 MB |  107556 MB |  102530 MB |
|       from small pool |      14 MB |      14 MB |      90 MB |      76 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1855 GB |    1855 GB |
|       from large pool |       0 KB |    1736 MB |    1837 GB |    1837 GB |
|       from small pool |    2108 KB |       4 MB |      18 GB |      18 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  151032    |  151014    |
|       from large pool |       0    |      11    |   15092    |   15092    |
|       from small pool |      18    |      37    |  135940    |  135922    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  151032    |  151014    |
|       from large pool |       0    |      11    |   15092    |   15092    |
|       from small pool |      18    |      37    |  135940    |  135922    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     291    |     273    |
|       from large pool |      11    |      11    |     246    |     235    |
|       from small pool |       7    |       7    |      45    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   67800    |   67792    |
|       from large pool |       0    |       8    |   11716    |   11716    |
|       from small pool |       8    |      14    |   56084    |   56076    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    2295 GB |    2295 GB |
|       from large pool |       0 KB |    2479 MB |    2280 GB |    2280 GB |
|       from small pool |    8131 KB |      11 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    2295 GB |    2295 GB |
|       from large pool |       0 KB |    2479 MB |    2280 GB |    2280 GB |
|       from small pool |    8131 KB |      11 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |  110940 MB |  107636 MB |
|       from large pool |    3290 MB |    5026 MB |  110846 MB |  107556 MB |
|       from small pool |      14 MB |      14 MB |      94 MB |      80 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1955 GB |    1955 GB |
|       from large pool |       0 KB |    1736 MB |    1936 GB |    1936 GB |
|       from small pool |    2108 KB |       4 MB |      19 GB |      19 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  159260    |  159242    |
|       from large pool |       0    |      11    |   15904    |   15904    |
|       from small pool |      18    |      37    |  143356    |  143338    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  159260    |  159242    |
|       from large pool |       0    |      11    |   15904    |   15904    |
|       from small pool |      18    |      37    |  143356    |  143338    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     303    |     286    |
|       from large pool |      10    |      11    |     256    |     246    |
|       from small pool |       7    |       7    |      47    |      40    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   71511    |   71503    |
|       from large pool |       0    |       8    |   12351    |   12351    |
|       from small pool |       8    |      14    |   59160    |   59152    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    2295 GB |    2295 GB |
|       from large pool |       0 KB |    2479 MB |    2280 GB |    2280 GB |
|       from small pool |    8131 KB |      11 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    2295 GB |    2295 GB |
|       from large pool |       0 KB |    2479 MB |    2280 GB |    2280 GB |
|       from small pool |    8131 KB |      11 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |  110940 MB |  107636 MB |
|       from large pool |    3290 MB |    5026 MB |  110846 MB |  107556 MB |
|       from small pool |      14 MB |      14 MB |      94 MB |      80 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1955 GB |    1955 GB |
|       from large pool |       0 KB |    1736 MB |    1936 GB |    1936 GB |
|       from small pool |    2108 KB |       4 MB |      19 GB |      19 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  159260    |  159242    |
|       from large pool |       0    |      11    |   15904    |   15904    |
|       from small pool |      18    |      37    |  143356    |  143338    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  159260    |  159242    |
|       from large pool |       0    |      11    |   15904    |   15904    |
|       from small pool |      18    |      37    |  143356    |  143338    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     303    |     286    |
|       from large pool |      10    |      11    |     256    |     246    |
|       from small pool |       7    |       7    |      47    |      40    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   71511    |   71503    |
|       from large pool |       0    |       8    |   12351    |   12351    |
|       from small pool |       8    |      14    |   59160    |   59152    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    2300 GB |    2300 GB |
|       from large pool |       0 KB |    2479 MB |    2284 GB |    2284 GB |
|       from small pool |    8131 KB |      11 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    2300 GB |    2300 GB |
|       from large pool |       0 KB |    2479 MB |    2284 GB |    2284 GB |
|       from small pool |    8131 KB |      11 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |  112676 MB |  107636 MB |
|       from large pool |    5026 MB |    5026 MB |  112582 MB |  107556 MB |
|       from small pool |      14 MB |      14 MB |      94 MB |      80 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    1958 GB |    1958 GB |
|       from large pool |       0 KB |    1736 MB |    1938 GB |    1938 GB |
|       from small pool |    2108 KB |       4 MB |      19 GB |      19 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  159358    |  159340    |
|       from large pool |       0    |      11    |   15923    |   15923    |
|       from small pool |      18    |      37    |  143435    |  143417    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  159358    |  159340    |
|       from large pool |       0    |      11    |   15923    |   15923    |
|       from small pool |      18    |      37    |  143435    |  143417    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     304    |     286    |
|       from large pool |      11    |      11    |     257    |     246    |
|       from small pool |       7    |       7    |      47    |      40    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   71550    |   71542    |
|       from large pool |       0    |       8    |   12362    |   12362    |
|       from small pool |       8    |      14    |   59188    |   59180    |
|===========================================================================|

Finishe one batch in training
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    2415 GB |    2415 GB |
|       from large pool |       0 KB |    2479 MB |    2399 GB |    2399 GB |
|       from small pool |    8131 KB |      11 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    2415 GB |    2415 GB |
|       from large pool |       0 KB |    2479 MB |    2399 GB |    2399 GB |
|       from small pool |    8131 KB |      11 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |  115970 MB |  112666 MB |
|       from large pool |    3290 MB |    5026 MB |  115872 MB |  112582 MB |
|       from small pool |      14 MB |      14 MB |      98 MB |      84 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    2058 GB |    2058 GB |
|       from large pool |       0 KB |    1736 MB |    2038 GB |    2038 GB |
|       from small pool |    2108 KB |       4 MB |      20 GB |      20 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  167586    |  167568    |
|       from large pool |       0    |      11    |   16735    |   16735    |
|       from small pool |      18    |      37    |  150851    |  150833    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  167586    |  167568    |
|       from large pool |       0    |      11    |   16735    |   16735    |
|       from small pool |      18    |      37    |  150851    |  150833    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     316    |     299    |
|       from large pool |      10    |      11    |     267    |     257    |
|       from small pool |       7    |       7    |      49    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   75242    |   75234    |
|       from large pool |       0    |       8    |   12997    |   12997    |
|       from small pool |       8    |      14    |   62245    |   62237    |
|===========================================================================|

Before evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    2415 GB |    2415 GB |
|       from large pool |       0 KB |    2479 MB |    2399 GB |    2399 GB |
|       from small pool |    8131 KB |      11 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    2415 GB |    2415 GB |
|       from large pool |       0 KB |    2479 MB |    2399 GB |    2399 GB |
|       from small pool |    8131 KB |      11 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3304 MB |    5040 MB |  115970 MB |  112666 MB |
|       from large pool |    3290 MB |    5026 MB |  115872 MB |  112582 MB |
|       from small pool |      14 MB |      14 MB |      98 MB |      84 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    2058 GB |    2058 GB |
|       from large pool |       0 KB |    1736 MB |    2038 GB |    2038 GB |
|       from small pool |    2108 KB |       4 MB |      20 GB |      20 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  167586    |  167568    |
|       from large pool |       0    |      11    |   16735    |   16735    |
|       from small pool |      18    |      37    |  150851    |  150833    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  167586    |  167568    |
|       from large pool |       0    |      11    |   16735    |   16735    |
|       from small pool |      18    |      37    |  150851    |  150833    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      18    |     316    |     299    |
|       from large pool |      10    |      11    |     267    |     257    |
|       from small pool |       7    |       7    |      49    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   75242    |   75234    |
|       from large pool |       0    |       8    |   12997    |   12997    |
|       from small pool |       8    |      14    |   62245    |   62237    |
|===========================================================================|

After evaluation in stopper
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8131 KB |    2488 MB |    2419 GB |    2419 GB |
|       from large pool |       0 KB |    2479 MB |    2404 GB |    2404 GB |
|       from small pool |    8131 KB |      11 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8131 KB |    2488 MB |    2419 GB |    2419 GB |
|       from large pool |       0 KB |    2479 MB |    2404 GB |    2404 GB |
|       from small pool |    8131 KB |      11 MB |      15 GB |      15 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    5040 MB |    5040 MB |  117706 MB |  112666 MB |
|       from large pool |    5026 MB |    5026 MB |  117608 MB |  112582 MB |
|       from small pool |      14 MB |      14 MB |      98 MB |      84 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2108 KB |    1737 MB |    2060 GB |    2060 GB |
|       from large pool |       0 KB |    1736 MB |    2040 GB |    2040 GB |
|       from small pool |    2108 KB |       4 MB |      20 GB |      20 GB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |      41    |  167684    |  167666    |
|       from large pool |       0    |      11    |   16754    |   16754    |
|       from small pool |      18    |      37    |  150930    |  150912    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |      41    |  167684    |  167666    |
|       from large pool |       0    |      11    |   16754    |   16754    |
|       from small pool |      18    |      37    |  150930    |  150912    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |     317    |     299    |
|       from large pool |      11    |      11    |     268    |     257    |
|       from small pool |       7    |       7    |      49    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      19    |   75280    |   75272    |
|       from large pool |       0    |       8    |   13008    |   13008    |
|       from small pool |       8    |      14    |   62272    |   62264    |
|===========================================================================|

After training size probing
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   19357 KB |    9814 MB |    2460 GB |    2460 GB |
|       from large pool |   19200 KB |    9813 MB |    2443 GB |    2443 GB |
|       from small pool |     157 KB |      11 MB |      16 GB |      16 GB |
|---------------------------------------------------------------------------|
| Active memory         |   19357 KB |    9814 MB |    2460 GB |    2460 GB |
|       from large pool |   19200 KB |    9813 MB |    2443 GB |    2443 GB |
|       from small pool |     157 KB |      11 MB |      16 GB |      16 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   47104 KB |    9842 MB |  144430 MB |  144384 MB |
|       from large pool |   45056 KB |    9838 MB |  144324 MB |  144280 MB |
|       from small pool |    2048 KB |      14 MB |     106 MB |     104 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   27746 KB |    3194 MB |    2084 GB |    2084 GB |
|       from large pool |   25856 KB |    3193 MB |    2064 GB |    2064 GB |
|       from small pool |    1890 KB |       6 MB |      20 GB |      20 GB |
|---------------------------------------------------------------------------|
| Allocations           |      12    |      41    |  168457    |  168445    |
|       from large pool |       6    |      17    |   16877    |   16871    |
|       from small pool |       6    |      37    |  151580    |  151574    |
|---------------------------------------------------------------------------|
| Active allocs         |      12    |      41    |  168457    |  168445    |
|       from large pool |       6    |      17    |   16877    |   16871    |
|       from small pool |       6    |      37    |  151580    |  151574    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       3    |      18    |     353    |     350    |
|       from large pool |       2    |      12    |     300    |     298    |
|       from small pool |       1    |       7    |      53    |      52    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      19    |   75582    |   75575    |
|       from large pool |       3    |       8    |   13055    |   13052    |
|       from small pool |       4    |      14    |   62527    |   62523    |
|===========================================================================|

After training size probing
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   19357 KB |    9814 MB |    2487 GB |    2487 GB |
|       from large pool |   19200 KB |    9813 MB |    2471 GB |    2471 GB |
|       from small pool |     157 KB |      11 MB |      16 GB |      16 GB |
|---------------------------------------------------------------------------|
| Active memory         |   19357 KB |    9814 MB |    2487 GB |    2487 GB |
|       from large pool |   19200 KB |    9813 MB |    2471 GB |    2471 GB |
|       from small pool |     157 KB |      11 MB |      16 GB |      16 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   47104 KB |    9842 MB |  164022 MB |  163976 MB |
|       from large pool |   45056 KB |    9838 MB |  163912 MB |  163868 MB |
|       from small pool |    2048 KB |      14 MB |     110 MB |     108 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   27746 KB |    3194 MB |    2101 GB |    2101 GB |
|       from large pool |   25856 KB |    3193 MB |    2081 GB |    2081 GB |
|       from small pool |    1890 KB |       6 MB |      20 GB |      20 GB |
|---------------------------------------------------------------------------|
| Allocations           |      12    |      41    |  168928    |  168916    |
|       from large pool |       6    |      17    |   16941    |   16935    |
|       from small pool |       6    |      37    |  151987    |  151981    |
|---------------------------------------------------------------------------|
| Active allocs         |      12    |      41    |  168928    |  168916    |
|       from large pool |       6    |      17    |   16941    |   16935    |
|       from small pool |       6    |      37    |  151987    |  151981    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       3    |      18    |     375    |     372    |
|       from large pool |       2    |      12    |     320    |     318    |
|       from small pool |       1    |       7    |      55    |      54    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      19    |   75768    |   75761    |
|       from large pool |       2    |       8    |   13067    |   13065    |
|       from small pool |       5    |      14    |   62701    |   62696    |
|===========================================================================|

